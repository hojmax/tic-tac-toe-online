(this.webpackJsonptictactoe=this.webpackJsonptictactoe||[]).push([[0],{21:function(e){e.exports=JSON.parse('{"lobbyCodeLength":8,"clientIDLength":16}')},22:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var o=n(2),c=n(3),a=n(10),r=n.n(a),s=n(4),l=n(9),i=(n(17),l.a.initializeApp({apiKey:"AIzaSyAmFYtVXhovd32ZhINx0AYp2obHhEbyZ1Q",authDomain:"sprintsolve.firebaseapp.com",databaseURL:"https://sprintsolve-default-rtdb.europe-west1.firebasedatabase.app",projectId:"sprintsolve",storageBucket:"sprintsolve.appspot.com",messagingSenderId:"931958489164",appId:"1:931958489164:web:7248abda53ede2ec9ef4e9",measurementId:"G-V4L6NX29HP"}),l.a.database());var b=function(e){var t=Object(c.useState)(void 0),n=Object(s.a)(t,2),a=n[0],r=n[1],l=Object(c.useState)(!1),b=Object(s.a)(l,2),d=b[0],u=b[1],j=Object(c.useState)(!1),f=Object(s.a)(j,2),p=f[0],h=f[1],y=function(t,n){var o=" 0.2s ease-in-out, fontBounce 0.2s ease-in-out";t.forEach((function(t){document.getElementById("cell".concat(3*t[1]+t[0])).style.animation=n===e.lobby.local.marking?"blackToGreen"+o:"blackToRed"+o,document.getElementById("cell".concat(3*t[1]+t[0])).style.color=n===e.lobby.local.marking?"green":"red"}))};Object(c.useEffect)((function(){r(function(e){for(var t=!1,n=0;n<3;n++){for(var o=0,c=0,a=0;a<3;a++)0===e[n][a]&&(t=!0),o+=e[n][a],c+=e[a][n];if(3===Math.abs(o)){for(var r=[],s=0;s<3;s++)r.push([s,n]);return y(r,o/3),o/3}if(3===Math.abs(c)){for(var l=[],i=0;i<3;i++)l.push([n,i]);return y(l,c/3),c/3}}for(var b=0,d=[[[0,0],[1,1],[2,2]],[[0,2],[1,1],[2,0]]];b<d.length;b++){var u=d[b],j=u.reduce((function(t,n){return t+e[n[1]][n[0]]}),0);if(3===Math.abs(j))return y(u,j/3),j/3}if(!t)return 0}(e.lobby.server.board)),u(!1)}),[e.lobby.server.board]);var m=function(){return e.lobby.local.clientID===e.lobby.server.players[e.lobby.server.clientTurn]},v=function(t,n){return!d&&m()&&void 0===a&&e.lobbyExists&&2===e.lobby.server.players.length&&0===e.lobby.server.board[n][t]};Object(c.useEffect)((function(){p&&document.getElementById("lobbyURL").select()}),[p]);var O=function(){if(e.lobby.server.players.length<2){var t=window.location.origin+window.location.pathname+"?"+e.lobby.local.code;return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("p",{children:"Waiting for opponent to join."}),Object(o.jsx)("div",{id:"loadingAnimation"}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsx)("p",{style:{margin:"0px 0px 10px 0px"},children:"Invite a friend with an URL:"}),Object(o.jsxs)("div",{children:[Object(o.jsx)("input",{id:"lobbyURL",type:"text",onClick:function(e){return e.target.select()},spellCheck:"false",readOnly:!0,value:t,size:t.length+1}),Object(o.jsx)("button",{onClick:function(e){!function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(t),h(!0),document.getElementById("lobbyURL").select()},id:"lobbyURLButton",children:p?Object(o.jsx)("i",{className:"fas fa-check"}):Object(o.jsx)("i",{className:"fas fa-link"})})]})]})}return Object(o.jsx)("p",{id:"bottomText",style:{animation:"flash 1s"},children:void 0===a?m()?"Your turn to move (".concat(1===e.lobby.local.marking?"X":"0",")."):"Waiting for opponent to move.":0===a?"The game has ended in a draw.":a===e.lobby.local.marking?Object(o.jsxs)("span",{children:["You ",Object(o.jsx)("span",{style:{color:"green"},children:"won"})," the game."]}):Object(o.jsxs)("span",{children:["You ",Object(o.jsx)("span",{style:{color:"red"},children:"lost"})," the game."]})})},x="1.5px solid rgb(50,50,50)",g=e.lobby.server.board.map((function(t,n){return Object(o.jsx)("tr",{children:t.map((function(t,c){return Object(o.jsx)("td",{onClick:function(){return function(t,n){if(v(t,n)){u(!0);var o={},c=1-e.lobby.server.players.indexOf(e.lobby.local.clientID);o["tictactoeGames/_"+e.lobby.local.code+"/board/"+n+"/"+t]=e.lobby.local.marking,o["tictactoeGames/_"+e.lobby.local.code+"/clientTurn"]=c,i.ref().update(o)}}(c,n)},id:"cell".concat(3*n+c),style:{cursor:v(c,n)?"pointer":"default",borderTop:0===n?"none":x,borderBottom:2===n?"none":x,borderLeft:0===c?"none":x,borderRight:2===c?"none":x,animation:0===t?void 0:"fontBounce 0.2s ease-in-out, flash 0.2s ease-in-out"},onAnimationEnd:function(){return document.getElementById("cell".concat(3*n+c)).style.animation="none"},className:"tictactoeCell",children:1===t?"X":-1===t?"O":""},c)}))},n)}));return Object(o.jsxs)("div",{children:[Object(o.jsx)("span",{onClick:function(){return window.location.search=""},className:"clickableSpan",children:"Main Menu"}),Object(o.jsxs)("center",{children:[Object(o.jsx)("table",{cellSpacing:"0",style:{fontSize:"40px"},children:Object(o.jsx)("tbody",{children:g})}),Object(o.jsx)(O,{lobby:e}),!e.lobbyExists&&Object(o.jsx)("p",{className:"errorMsg",children:"Opponent disconnected."})]})]})};var d=function(e){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n="",o=0;o<e;o++)n+=t[Math.floor(Math.random()*t.length)];return n};var u=function(e){var t=n(21),a=Object(c.useState)(""),r=Object(s.a)(a,2),l=r[0],b=r[1],u=Object(c.useState)(!1),j=Object(s.a)(u,2),f=j[0],p=j[1],h=Object(c.useState)(!1),y=Object(s.a)(h,2),m=y[0],v=y[1],O=d(t.clientIDLength),x=function(t){var n;i.ref("tictactoeGames/_"+t).once("value",(function(e){var t=e.val();n=O===t.players[t.clientTurn]?1:-1})).then((function(){i.ref("tictactoeGames/_"+t).on("value",(function(o){if(o.exists()){var c=o.val();e.setLobbyExists(!0),e.setLobby({server:c,local:{marking:n,clientID:O,code:t}})}else e.setLobbyExists(!1)}))})),i.ref("tictactoeGames/_"+t).onDisconnect().remove()};return Object(c.useEffect)((function(){var e,n=window.location.search.substring(1,t.lobbyCodeLength+1);n?(e=n,f||(p(!0),i.ref("tictactoeGames/_"+e).once("value").then((function(t){if(t.exists()){var n=t.val();n.players.length<2&&i.ref("tictactoeGames/_"+e+"/players").set([n.players[0],O]).then(x(e))}else b("The challenge link is invalid."),v(!0),p(!1)})))):v(!0)}),[]),m?Object(o.jsxs)("center",{children:[Object(o.jsx)("h1",{children:"Tic-Tac-Toe Online"}),Object(o.jsxs)("p",{children:["Create a new lobby ",Object(o.jsx)("span",{className:"clickableSpan",onClick:function(){if(!f){p(!0);var e=d(t.lobbyCodeLength);i.ref("tictactoeGames/_"+e).set({board:[[0,0,0],[0,0,0],[0,0,0]],players:[O],clientTurn:Math.floor(2*Math.random())}).then((function(){x(e)}))}},children:"here."})]}),l&&Object(o.jsx)("p",{className:"errorMsg",children:l})]}):Object(o.jsx)(o.Fragment,{})};n(22);var j=function(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),l=Object(s.a)(r,2),i=l[0],d=l[1];return console.log(window.location),n?Object(o.jsx)(b,{lobbyExists:i,lobby:n}):Object(o.jsx)(u,{setLobbyExists:d,setLobby:a})};r.a.render(Object(o.jsx)(j,{}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.80a2b2a1.chunk.js.map